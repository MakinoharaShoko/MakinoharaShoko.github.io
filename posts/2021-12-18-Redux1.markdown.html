<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/7835419622e5afa0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7835419622e5afa0.css" data-n-g=""/><link rel="preload" href="/_next/static/css/50425c9106578cba.css" as="style"/><link rel="stylesheet" href="/_next/static/css/50425c9106578cba.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-59c5c889f52620d6.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-5020794388548d5e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9cd66785574873e8.js" defer=""></script><script src="/_next/static/chunks/175675d1-7de8b3bfdcedb0f1.js" defer=""></script><script src="/_next/static/chunks/9f96d65d-c9e0543547ce45e9.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-c0ab723d8d52e6df.js" defer=""></script><script src="/_next/static/_PQfbmLHnVN3d0QW7vZpv/_buildManifest.js" defer=""></script><script src="/_next/static/_PQfbmLHnVN3d0QW7vZpv/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="mainLayout_out__ZYqWw" style="height:calc(100vh - var(--vh-offset, 0px))"><div class="mainLayout_mainarea__QxaY0"><div class="post_post__ejhnw"><div class="post_top__JuBkM"><div class="post_b__Bj3sV"><img alt="back" src="/_next/static/media/back.f6d17d78.png" width="480" height="480" decoding="async" data-nimg="1" class="post_bi__9ghX8" loading="lazy" style="color:transparent"/></div><div class="post_tit__Xu2qi">Redux初体验<img alt="open" src="/_next/static/media/down.9feac32f.png" width="480" height="480" decoding="async" data-nimg="1" class="post_iconSmall__5Hxz8" loading="lazy" style="color:transparent"/></div><div class="post_b__Bj3sV"><img alt="close" src="/_next/static/media/close.315313d8.png" width="480" height="480" decoding="async" data-nimg="1" class="post_bi__9ghX8" loading="lazy" style="color:transparent"/></div></div><div class="post_mdWarpper__Brjcd"><div class="markdown-body post_md__a6C1y"><h1 id="redux初体验">Redux初体验</h1>
<h2 id="概念图">概念图</h2>
<p><img src="/img/redux.jpg" alt="redux"/></p>
<h2 id="1创建store类似于全局变量存储仓库">1、创建Store（类似于全局变量存储仓库）</h2>
<pre><code class="language-js">import {createStore} from &quot;redux&quot;;
import reducer from &quot;./reducer&quot;;

//window.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; window.__REDUX_DEVTOOLS_EXTENSION__() 是为了在DevTools调试，可以不加
const store = createStore(reducer,window.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; window.__REDUX_DEVTOOLS_EXTENSION__());

export default store;
</code></pre>
<h2 id="2创建reducer相当于全局变量管理器">2、创建Reducer（相当于全局变量管理器）</h2>
<pre><code class="language-js">const defaultStore = {
    inputValue:&#x27;Write something&#x27;,
    list:[
        &#x27;搞114514&#x27;,
        &#x27;坐下北泽JR&#x27;
    ]
};

export default (state = defaultStore,action)=&gt;{
    console.log(state);
    console.log(action);
    if(action.type === &#x27;value/changeInput&#x27;){
        let newState = JSON.parse(JSON.stringify(state));
        newState.inputValue = action.payload;
        return newState;
    }
    return state;
}
</code></pre>
<h2 id="3在组件里调用仓库内容">3、在组件里调用仓库内容</h2>
<pre><code class="language-jsx">import &#x27;./App.css&#x27;;
import store from &quot;./store&quot;;
import {useState} from &quot;react&quot;;
import { Input } from &#x27;antd&#x27;;
import &#x27;antd/dist/antd.css&#x27;;

function App() {
    //初始化HOOK：取出store里的state
    const [appData,setAppData] = useState(store.getState());
    //当store变动时，调用回调函数（这里是setAppData）
    store.subscribe(()=&gt;{setAppData(store.getState())});
    let list = appData.list;
    let inputValue = appData.inputValue;
    let page = [];
    console.log(store.getState())
    for (let i = 0; i &lt; list.length; i++) {
        let temp = &lt;div&gt;{list[i]}&lt;/div&gt;
        page.push(temp);
    }

    const changeInputValue = (e)=&gt;{
        // 创建action
        const action = {
            type:&#x27;value/changeInput&#x27;,
            payload:e.target.value
        }
        // 使action生效（也就是传给reducer，判断后更新store中的state）
        store.dispatch(action);
    }

    return (
        &lt;div&gt;
            &lt;Input placeholder={&quot;Write Something&quot;} onChange={changeInputValue}/&gt;
            {page}
            &lt;div&gt;
                {inputValue}
            &lt;/div&gt;
        &lt;/div&gt;
    );
}

export default App;

</code></pre>
<p>如此一来，就实现了类似于全局变量管理的模式（你可以为每一个需要管理的全局状态创建store）</p>
<h2 id="将store和reducer写到一起">将Store和Reducer写到一起</h2>
<pre><code class="language-js">import {createStore} from &quot;redux&quot;;

//初始化
const defaultStore = {
    inputValue:&#x27;Write something&#x27;,
    list:[
        &#x27;搞114514&#x27;,
        &#x27;坐下北泽JR&#x27;
    ]
};

const reducer =  (state = defaultStore,action)=&gt;{
    //判断action的类型，改变state的指定属性
    if(action.type === &#x27;value/changeInput&#x27;){
        let newState = JSON.parse(JSON.stringify(state));
        newState.inputValue = action.payload;
        return newState;
    }
    return state;
}

const appStore = createStore(reducer,window.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; window.__REDUX_DEVTOOLS_EXTENSION__());

export default appStore;
</code></pre>
<p><strong>对应的App代码</strong></p>
<pre><code class="language-jsx">import &#x27;./App.css&#x27;;
import appStore from &quot;./store/appReducer&quot;;
import {useState} from &quot;react&quot;;
import { Input } from &#x27;antd&#x27;;
import &#x27;antd/dist/antd.css&#x27;;

function App() {
    //初始化HOOK：取出store里的state
    const [appData,setAppData] = useState(appStore.getState());
    //当store变动时，调用回调函数（这里是setAppData）
    appStore.subscribe(()=&gt;{setAppData(appStore.getState())});
    let list = appData.list;
    let inputValue = appData.inputValue;
    let page = [];
    console.log(appStore.getState())
    for (let i = 0; i &lt; list.length; i++) {
        let temp = &lt;div&gt;{list[i]}&lt;/div&gt;
        page.push(temp);
    }

    const changeInputValue = (e)=&gt;{
        // 创建action
        const action = {
            type:&#x27;value/changeInput&#x27;,
            payload:e.target.value
        }
        // 使action生效（也就是传给reducer，判断后更新store中的state）
        appStore.dispatch(action);
    }

    return (
        &lt;div&gt;
            &lt;Input placeholder={&quot;Write Something&quot;} onChange={changeInputValue}/&gt;
            {page}
            &lt;div&gt;
                {inputValue}
            &lt;/div&gt;
        &lt;/div&gt;
    );
}

export default App;

</code></pre>
<h2 id="action-creator">Action Creator</h2>
<p>添加了 Action Creator 的处理方法：</p>
<pre><code class="language-js">//初始化
const defaultStore =&#x27;Write something&#x27;;

const inputValue =  (state = defaultStore, action)=&gt;{
    //判断action的类型，改变state的指定属性
    if(action.type === &#x27;value/changeInput&#x27;){
        let newState = JSON.parse(JSON.stringify(state));
        newState = action.payload;
        return newState;
    }
    return state;
}

export class inputValueAction{
    static changeInput = (input) =&gt;{
        return {
            type:&#x27;value/changeInput&#x27;,
            payload:input
        }
    }
}

export default inputValue;
</code></pre>
<p>将所有相关与某个要发送数据的 action creator 放到一个类中，方便调用</p></div></div></div></div><div class="mainLayout_bottom__As9s_"><div class="mainLayout_tag__Ep3_f"><img alt="launcher" src="/_next/static/media/launcher.d8f01379.png" width="1024" height="1024" decoding="async" data-nimg="1" class="mainLayout_tagImg__qoDJq" loading="lazy" style="color:transparent"/></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":"---\nlayout:     post\ntitle:      Redux初体验\nintro:   \"\"\ndate:       2021-12-18 12:00:01\nauthor:     \"Makinohara\"\ncatalog: true\ntags:\n    - 工程开发\n    \n---\n\n# Redux初体验\n\n## 概念图\n\n![redux](/img/redux.jpg)\n\n## 1、创建Store（类似于全局变量存储仓库）\n\n```js\nimport {createStore} from \"redux\";\nimport reducer from \"./reducer\";\n\n//window.__REDUX_DEVTOOLS_EXTENSION__ \u0026\u0026 window.__REDUX_DEVTOOLS_EXTENSION__() 是为了在DevTools调试，可以不加\nconst store = createStore(reducer,window.__REDUX_DEVTOOLS_EXTENSION__ \u0026\u0026 window.__REDUX_DEVTOOLS_EXTENSION__());\n\nexport default store;\n```\n\n## 2、创建Reducer（相当于全局变量管理器）\n\n```js\nconst defaultStore = {\n    inputValue:'Write something',\n    list:[\n        '搞114514',\n        '坐下北泽JR'\n    ]\n};\n\nexport default (state = defaultStore,action)=\u003e{\n    console.log(state);\n    console.log(action);\n    if(action.type === 'value/changeInput'){\n        let newState = JSON.parse(JSON.stringify(state));\n        newState.inputValue = action.payload;\n        return newState;\n    }\n    return state;\n}\n```\n\n## 3、在组件里调用仓库内容\n\n```jsx\nimport './App.css';\nimport store from \"./store\";\nimport {useState} from \"react\";\nimport { Input } from 'antd';\nimport 'antd/dist/antd.css';\n\nfunction App() {\n    //初始化HOOK：取出store里的state\n    const [appData,setAppData] = useState(store.getState());\n    //当store变动时，调用回调函数（这里是setAppData）\n    store.subscribe(()=\u003e{setAppData(store.getState())});\n    let list = appData.list;\n    let inputValue = appData.inputValue;\n    let page = [];\n    console.log(store.getState())\n    for (let i = 0; i \u003c list.length; i++) {\n        let temp = \u003cdiv\u003e{list[i]}\u003c/div\u003e\n        page.push(temp);\n    }\n\n    const changeInputValue = (e)=\u003e{\n        // 创建action\n        const action = {\n            type:'value/changeInput',\n            payload:e.target.value\n        }\n        // 使action生效（也就是传给reducer，判断后更新store中的state）\n        store.dispatch(action);\n    }\n\n    return (\n        \u003cdiv\u003e\n            \u003cInput placeholder={\"Write Something\"} onChange={changeInputValue}/\u003e\n            {page}\n            \u003cdiv\u003e\n                {inputValue}\n            \u003c/div\u003e\n        \u003c/div\u003e\n    );\n}\n\nexport default App;\n\n```\n\n如此一来，就实现了类似于全局变量管理的模式（你可以为每一个需要管理的全局状态创建store）\n\n## 将Store和Reducer写到一起\n\n```js\nimport {createStore} from \"redux\";\n\n//初始化\nconst defaultStore = {\n    inputValue:'Write something',\n    list:[\n        '搞114514',\n        '坐下北泽JR'\n    ]\n};\n\nconst reducer =  (state = defaultStore,action)=\u003e{\n    //判断action的类型，改变state的指定属性\n    if(action.type === 'value/changeInput'){\n        let newState = JSON.parse(JSON.stringify(state));\n        newState.inputValue = action.payload;\n        return newState;\n    }\n    return state;\n}\n\nconst appStore = createStore(reducer,window.__REDUX_DEVTOOLS_EXTENSION__ \u0026\u0026 window.__REDUX_DEVTOOLS_EXTENSION__());\n\nexport default appStore;\n```\n\n**对应的App代码**\n\n```jsx\nimport './App.css';\nimport appStore from \"./store/appReducer\";\nimport {useState} from \"react\";\nimport { Input } from 'antd';\nimport 'antd/dist/antd.css';\n\nfunction App() {\n    //初始化HOOK：取出store里的state\n    const [appData,setAppData] = useState(appStore.getState());\n    //当store变动时，调用回调函数（这里是setAppData）\n    appStore.subscribe(()=\u003e{setAppData(appStore.getState())});\n    let list = appData.list;\n    let inputValue = appData.inputValue;\n    let page = [];\n    console.log(appStore.getState())\n    for (let i = 0; i \u003c list.length; i++) {\n        let temp = \u003cdiv\u003e{list[i]}\u003c/div\u003e\n        page.push(temp);\n    }\n\n    const changeInputValue = (e)=\u003e{\n        // 创建action\n        const action = {\n            type:'value/changeInput',\n            payload:e.target.value\n        }\n        // 使action生效（也就是传给reducer，判断后更新store中的state）\n        appStore.dispatch(action);\n    }\n\n    return (\n        \u003cdiv\u003e\n            \u003cInput placeholder={\"Write Something\"} onChange={changeInputValue}/\u003e\n            {page}\n            \u003cdiv\u003e\n                {inputValue}\n            \u003c/div\u003e\n        \u003c/div\u003e\n    );\n}\n\nexport default App;\n\n```\n\n\n\n## Action Creator\n\n添加了 Action Creator 的处理方法：\n\n```js\n//初始化\nconst defaultStore ='Write something';\n\nconst inputValue =  (state = defaultStore, action)=\u003e{\n    //判断action的类型，改变state的指定属性\n    if(action.type === 'value/changeInput'){\n        let newState = JSON.parse(JSON.stringify(state));\n        newState = action.payload;\n        return newState;\n    }\n    return state;\n}\n\nexport class inputValueAction{\n    static changeInput = (input) =\u003e{\n        return {\n            type:'value/changeInput',\n            payload:input\n        }\n    }\n}\n\nexport default inputValue;\n```\n\n将所有相关与某个要发送数据的 action creator 放到一个类中，方便调用\n"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"2021-12-18-Redux1.markdown"},"buildId":"_PQfbmLHnVN3d0QW7vZpv","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>